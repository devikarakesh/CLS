
{% extends 'admin/adminbase.html' %}
{% block body %}

<style>
  body{
        background-color: rgb(211, 227, 244);
        background-image: url('https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.kozhikode.directory%2Fst-josephs-college-autonomous-devagiri%2Fi%2F344&psig=AOvVaw3LYg9m0knQJvFidsrfLJen&ust=1731576530062000&source=images&cd=vfe&opi=89978449&ved=0CBQQjRxqFwoTCOi07LL_2IkDFQAAAAAdAAAAABAJ');
       }
  .lab{
       padding: 62px;
       max-width: 500px;
       background-color: #2f5b8d;
      border-radius: 5px;
      box-shadow:0 0 50px rgba(5,2, 1, 0.1);
      overflow: auto;
      margin-left: 600px;
     margin-top: 150px;
     
     
  }        
  .sch{
       margin-bottom: 15px;
       color: rgb(241, 236, 236);
      
  }
  .sch input{
      width: 100%;
      padding: 15px;
      border-radius: 5px;
      border: 1px solid black;
      background-color: white;
      margin-top: 5px;
      color: rgb(2, 2, 2);
  }
  .sch button{
      background-color:rgb(1, 13, 39);
      padding: 10px;
      width: 100%;
      text-align: center;
      color: white;
      font-size: 15px;
  }
  .sch textarea{
width: 100%;
padding: 8px;
border-radius: 4px;
background-color: white;
font-size: 16px;

}
.sch label{
  font-size: 15px;
  font-style: normal;
  color: whitesmoke;
  margin-bottom: 10px;
}
.inp input{
    background-color:rgb(1, 13, 39);
      padding: 10px;
      width: 100%;
      text-align: center;
      color: white;
      font-size: 15px;

  }
</style>


<div class="lab">
  <form method="post" action="">
    {% csrf_token %}
  <div style="font-size: 25px;text-align: center;"><b>POST NOTIFICATIONS</b></div>
  <div class="sch">
    <label for="notification">POST</label>
 
    <textarea name="notification" id="notification" rows="2" cols="20" required>{{ notificationobject.notification }}</textarea>
    <span id="notificationError" style="color: red;"></span>
 
  </div>
  
  <div class="sch">
    <label for="notificationdate">Date</label>
    <input type="date" id="notificationdate" name="notificationdate" value="{{ notificationobject.notificationdate }}" required>
    <span id="dateError" style="color: red;"></span>
  </div>
  
  <div class="inp">
    <input type="submit" id="submitBtn" value="UPDATE" disabled>
  </div>
  </form>
  </div>
  
  <script>
  document.addEventListener("DOMContentLoaded", function () {
  let today = new Date().toISOString().split('T')[0];
  let dateInput = document.getElementById("notificationdate");
  
  // Set default date if empty and restrict past dates
  if (!dateInput.value) {
    dateInput.value = today;
  }
  dateInput.min = today;
  
  // Enable submit button only when the form is valid
  document.getElementById("notification").addEventListener("input", validateNotification);
  document.getElementById("notificationdate").addEventListener("input", validateNotification);
  });
  
  function validateNotification() {
  let isValid = true;
  
  let notification = document.getElementById("notification").value.trim();
  let notificationError = document.getElementById("notificationError");
  let dateInput = document.getElementById("notificationdate").value;
  let dateError = document.getElementById("dateError");
  let submitBtn = document.getElementById("submitBtn");
  
  // Reset previous error messages
  notificationError.innerText = "";
  dateError.innerText = "";
  
  // ✅ Notification Validations
  if (notification.length < 10) {
    notificationError.innerText = "Notification must be at least 10 characters long.";
    isValid = false;
  }
  
  if (notification.length > 500) {
    notificationError.innerText = "Notification cannot exceed 500 characters.";
    isValid = false;
  }
  
  // Prevent < and > characters (avoid XSS)
  let pattern = /[<>]/g;
  if (pattern.test(notification)) {
    notificationError.innerText = "Invalid characters detected. Avoid using < or >.";
    isValid = false;
  }
  
  // ✅ Date Validation
  let today = new Date().toISOString().split('T')[0];
  if (dateInput < today) {
    dateError.innerText = "Date cannot be in the past.";
    isValid = false;
  }
  
  // Enable or disable submit button based on validation
  submitBtn.disabled = !isValid;
  return isValid;
  }
  </script>
  
  
    
  
  {% endblock %}